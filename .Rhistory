print(alignment)
delRange
insRange
delRange <- deletion(alignment)[[1]]
insRange <- insertion(alignment)[[1]]
delRange
insRange
delRange
delRange <- deletion(alignment)[[1]]
insRange <- insertion(alignment)[[1]]
newPos <- rep(NA, length(pos))
newAA <- rep(NA, length(pos))
newPos[i] <- pos[i] +
sum(width(delRange)[start(delRange) <= pos[i]]) -
sum(width(insRange)[start(insRange) < pos[i]])
s <- subject(alignment)
newAA[i] <- substr(as.character(unaligned(s)), newPos[i], newPos[i])
newPos[i]
translatePosition <- function(pos, alignment){
delRange <- deletion(alignment)[[1]]
insRange <- insertion(alignment)[[1]]
newPos <- rep(NA, length(pos))
newAA <- rep(NA, length(pos))
for(i in 1:length(pos)){
newPos[i] <- pos[i] +
sum(width(delRange)[start(delRange) <= pos[i]]) -
sum(width(insRange)[start(insRange) < pos[i]])
s <- subject(alignment)
newAA[i] <- substr(as.character(unaligned(s)), newPos[i], newPos[i])
}
}
translatePosition <- function(pos, alignment){
delRange <- deletion(alignment)[[1]]
insRange <- insertion(alignment)[[1]]
newPos <- rep(NA, length(pos))
newAA <- rep(NA, length(pos))
for(i in 1:length(pos)){
newPos[i] <- pos[i] +
sum(width(delRange)[start(delRange) <= pos[i]]) -
sum(width(insRange)[start(insRange) < pos[i]])
s <- subject(alignment)
newAA[i] <- substr(as.character(unaligned(s)), newPos[i], newPos[i])
}
return(list(newPos, newAA))
}
alignment <- getAlignment(names(uniprotHuman2Mouse)[i], uniprotHuman2Mouse[[i]][j],
upHs, upMm)
mSites <- hSites %>%
dplyr::filter(!duplicated(accAASite))
translatePosition(mSites$position, alignment)
tRes <- translatePosition(mSites$position, alignment)
translatePosition <- function(pos, alignment){
delRange <- deletion(alignment)[[1]]
insRange <- insertion(alignment)[[1]]
newPos <- rep(NA, length(pos))
newAA <- rep(NA, length(pos))
for(i in 1:length(pos)){
newPos[i] <- pos[i] +
sum(width(delRange)[start(delRange) <= pos[i]]) -
sum(width(insRange)[start(insRange) < pos[i]])
s <- subject(alignment)
newAA[i] <- substr(as.character(unaligned(s)), newPos[i], newPos[i])
}
return(list(pos = newPos, AA = newAA))
}
tRes <- translatePosition(mSites$position, alignment)
mSites$newAcc <- rep(uniprotHuman2Mouse[[i]][j], nrow(mSites))
mSites$newAA <- tRes$AA
mSites$newPos <- tRes$pos
mSites <- mSites %>%
mutate(newAccAASite = paste0(newAcc, "_", newAA, newPos))
length(uniprotHuman2Mouse)
#for(i in 1:length(uniprotHuman2Mouse)){
for(i in 1:20){
hSites <- dplyr::filter(networKINu, Entry == names(uniprotHuman2Mouse)[i])
human2mouseSites[[i]] <- list()
names(human2mouseSites)[i] <- names(uniprotHuman2Mouse)[i]
if(!is.null(length(uniprotHuman2Mouse))){
for(j in 1:length(uniprotHuman2Mouse[[i]])){
alignment <- getAlignment(names(uniprotHuman2Mouse)[i], uniprotHuman2Mouse[[i]][j],
upHs, upMm)
mSites <- hSites %>%
dplyr::filter(!duplicated(accAASite))
tRes <- translatePosition(mSites$position, alignment)
mSites$newAcc <- rep(uniprotHuman2Mouse[[i]][j], nrow(mSites))
mSites$newAA <- tRes$AA
mSites$newPos <- tRes$pos
mSites <- mSites %>%
mutate(newAccAASite = paste0(newAcc, "_", newAA, newPos))
human2mouseSites[[i]][[j]] <- mSites
}
}
}
i
j
acc1 <- names(uniprotHuman2Mouse)[1]
acc2 <- uniprotHuman2Mouse[[1]][2]
up1 <- upHs
up2 <- upMm
humanSequence <- select(up1,
keys = c(acc1),
columns = c("SEQUENCE"),
keytype = "UNIPROTKB")
mouseSequence <- select(up2,
keys = c(acc2),
columns = c("SEQUENCE"),
keytype = "UNIPROTKB")
acc2
acc1
clusterSpecies <- base::strsplit(uniprot2refseqGroups$Organisms[i], "; ")[[1]]
clusterProteins <- base::strsplit(uniprot2refseqGroups$Cluster.members[i], "; ")[[1]]
clusterProteins
clusterSpecies
clusterSpecies <- base::strsplit(uniprot2refseqGroups$Organisms[i], "; ")[[1]]
clusterProteins <- base::strsplit(uniprot2refseqGroups$Cluster.members[i], "; ")[[1]]
clusterSpecies
clusterProteins
length(clustersped)
length(clusterSpecies)
length(clusterProteins)
clusterSpecies
uniprot2refseqGroups[[1]]
uniprot2refseqGroups[1,]
## load mouse proteome data for filtering
mouseProteome <- read.delim("data/uniprot-taxonomy_10090.tab.gz", stringsAsFactors = FALSE)
mouseProteome
uniprotHuman2Mouse <- list()
for(i in 1:nrow(uniprot2refseqGroups)){
clusterProteins <- base::strsplit(uniprot2refseqGroups$Cluster.members[i], "; ")[[1]]
uniprotHuman2Mouse[[i]] <- clusterProteins[clusterProteins %in% mouseProteome$Entry]
names(uniprotHuman2Mouse)[i] <- uniprot2refseqGroups$uniprot[i]
}
getAlignment <- function(acc1, acc2, up1, up2){
humanSequence <- select(up1,
keys = c(acc1),
columns = c("SEQUENCE"),
keytype = "UNIPROTKB")
mouseSequence <- select(up2,
keys = c(acc2),
columns = c("SEQUENCE"),
keytype = "UNIPROTKB")
alignment <- pairwiseAlignment(humanSequence$SEQUENCE,
mouseSequence$SEQUENCE,
substitutionMatrix = "BLOSUM50", gapOpening = -2,
gapExtension = -8, scoreOnly = FALSE)
alignment
}
translatePosition <- function(pos, alignment){
delRange <- deletion(alignment)[[1]]
insRange <- insertion(alignment)[[1]]
newPos <- rep(NA, length(pos))
newAA <- rep(NA, length(pos))
for(i in 1:length(pos)){
newPos[i] <- pos[i] +
sum(width(delRange)[start(delRange) <= pos[i]]) -
sum(width(insRange)[start(insRange) < pos[i]])
s <- subject(alignment)
newAA[i] <- substr(as.character(unaligned(s)), newPos[i], newPos[i])
}
return(list(pos = newPos, AA = newAA))
}
human2mouseSites <- list()
#for(i in 1:length(uniprotHuman2Mouse)){
for(i in 1:20){
hSites <- dplyr::filter(networKINu, Entry == names(uniprotHuman2Mouse)[i])
human2mouseSites[[i]] <- list()
names(human2mouseSites)[i] <- names(uniprotHuman2Mouse)[i]
if(!is.null(length(uniprotHuman2Mouse))){
for(j in 1:length(uniprotHuman2Mouse[[i]])){
alignment <- getAlignment(names(uniprotHuman2Mouse)[i], uniprotHuman2Mouse[[i]][j],
upHs, upMm)
mSites <- hSites %>%
dplyr::filter(!duplicated(accAASite))
tRes <- translatePosition(mSites$position, alignment)
mSites$newAcc <- rep(uniprotHuman2Mouse[[i]][j], nrow(mSites))
mSites$newAA <- tRes$AA
mSites$newPos <- tRes$pos
mSites <- mSites %>%
mutate(newAccAASite = paste0(newAcc, "_", newAA, newPos))
human2mouseSites[[i]][[j]] <- mSites
}
}
}
i
j
acc1 <- names(uniprotHuman2Mouse)[i]
acc2 <- uniprotHuman2Mouse[[i]][j]
acc1
acc2
uniprotHuman2Mouse[[1]]
uniprotHuman2Mouse[[4]]
sapply(uniprotHuman2Mouse, length)
sapply(uniprotHuman2Mouse, length) > 0
uniprotHuman2Mouse <- uniprotHuman2Mouse[[sapply(uniprotHuman2Mouse, length) > 0 ]]
uniprotHuman2Mouse <- uniprotHuman2Mouse[sapply(uniprotHuman2Mouse, length) > 0 ]
sapply(uniprotHuman2Mouse, length)
length(uniprotHuman2Mouse)
human2mouseSites <- list()
#for(i in 1:length(uniprotHuman2Mouse)){
for(i in 1:20){
hSites <- dplyr::filter(networKINu, Entry == names(uniprotHuman2Mouse)[i])
human2mouseSites[[i]] <- list()
names(human2mouseSites)[i] <- names(uniprotHuman2Mouse)[i]
if(!is.null(length(uniprotHuman2Mouse))){
for(j in 1:length(uniprotHuman2Mouse[[i]])){
alignment <- getAlignment(names(uniprotHuman2Mouse)[i], uniprotHuman2Mouse[[i]][j],
upHs, upMm)
mSites <- hSites %>%
dplyr::filter(!duplicated(accAASite))
tRes <- translatePosition(mSites$position, alignment)
mSites$newAcc <- rep(uniprotHuman2Mouse[[i]][j], nrow(mSites))
mSites$newAA <- tRes$AA
mSites$newPos <- tRes$pos
mSites <- mSites %>%
mutate(newAccAASite = paste0(newAcc, "_", newAA, newPos))
human2mouseSites[[i]][[j]] <- mSites
}
}
}
i
j
acc1 <- names(uniprotHuman2Mouse)[i]
acc2 <- uniprotHuman2Mouse[[i]][j]
up1 <- upHs
up2 <- upMm
acc1
acc2
names(uniprotHuman2Mouse)
networKINu$Entry
unique(networKINu$Entry)
uniprot2refseqGroups$uniprot
## make uniprot2refseq50
writeClipboard(ensembl2uniprot$Entry)
## split clusters containing multiple human proteins
base::strsplit(names(uniprotHuman2Mouse), ", ")
## split clusters containing multiple human proteins
base::strsplit(names(uniprotHuman2Mouse), ",")
## split clusters containing multiple human proteins
newNameList <- base::strsplit(names(uniprotHuman2Mouse), ",")
## split clusters containing multiple human proteins
newNameList <- base::strsplit(names(uniprotHuman2Mouse), ",")
sapply(newNameList, length)
1:length(uniprotHuman2Mouse), sapply(newNameList, length)
rep(1:length(uniprotHuman2Mouse), sapply(newNameList, length))
temp <- uniprotHuman2Mouse[rep(1:length(uniprotHuman2Mouse), sapply(newNameList, length))]
length(temp)
length(uniprotHuman2Mouse)
length(temp)
names(temp) <- unlist(newNameList)
uniprotHuman2Mouse <- temp
uniprotHuman2Mouse <- list()
for(i in 1:nrow(uniprot2refseqGroups)){
clusterProteins <- base::strsplit(uniprot2refseqGroups$Cluster.members[i], "; ")[[1]]
uniprotHuman2Mouse[[i]] <- clusterProteins[clusterProteins %in% mouseProteome$Entry]
names(uniprotHuman2Mouse)[i] <- uniprot2refseqGroups$uniprot[i]
}
uniprotHuman2Mouse <- uniprotHuman2Mouse[sapply(uniprotHuman2Mouse, length) > 0 ]
## split clusters containing multiple human proteins
newNameList <- base::strsplit(names(uniprotHuman2Mouse), ",")
temp <- uniprotHuman2Mouse[rep(1:length(uniprotHuman2Mouse), sapply(newNameList, length))]
names(temp) <- unlist(newNameList)
length(uniprotHuman2Mouse)
length(temp)
uniprotHuman2Mouse <- temp
getAlignment <- function(acc1, acc2, up1, up2){
humanSequence <- select(up1,
keys = c(acc1),
columns = c("SEQUENCE"),
keytype = "UNIPROTKB")
mouseSequence <- select(up2,
keys = c(acc2),
columns = c("SEQUENCE"),
keytype = "UNIPROTKB")
alignment <- pairwiseAlignment(humanSequence$SEQUENCE,
mouseSequence$SEQUENCE,
substitutionMatrix = "BLOSUM50", gapOpening = -2,
gapExtension = -8, scoreOnly = FALSE)
alignment
}
# acc1 <- names(uniprotHuman2Mouse)[i]
# acc2 <- uniprotHuman2Mouse[[i]][j]
# up1 <- upHs
# up2 <- upMm
#pos <- 154
translatePosition <- function(pos, alignment){
delRange <- deletion(alignment)[[1]]
insRange <- insertion(alignment)[[1]]
newPos <- rep(NA, length(pos))
newAA <- rep(NA, length(pos))
for(i in 1:length(pos)){
newPos[i] <- pos[i] +
sum(width(delRange)[start(delRange) <= pos[i]]) -
sum(width(insRange)[start(insRange) < pos[i]])
s <- subject(alignment)
newAA[i] <- substr(as.character(unaligned(s)), newPos[i], newPos[i])
}
return(list(pos = newPos, AA = newAA))
}
human2mouseSites <- list()
#for(i in 1:length(uniprotHuman2Mouse)){
for(i in 1:20){
hSites <- dplyr::filter(networKINu, Entry == names(uniprotHuman2Mouse)[i])
human2mouseSites[[i]] <- list()
names(human2mouseSites)[i] <- names(uniprotHuman2Mouse)[i]
if(!is.null(length(uniprotHuman2Mouse))){
for(j in 1:length(uniprotHuman2Mouse[[i]])){
alignment <- getAlignment(names(uniprotHuman2Mouse)[i], uniprotHuman2Mouse[[i]][j],
upHs, upMm)
mSites <- hSites %>%
dplyr::filter(!duplicated(accAASite))
tRes <- translatePosition(mSites$position, alignment)
mSites$newAcc <- rep(uniprotHuman2Mouse[[i]][j], nrow(mSites))
mSites$newAA <- tRes$AA
mSites$newPos <- tRes$pos
mSites <- mSites %>%
mutate(newAccAASite = paste0(newAcc, "_", newAA, newPos))
human2mouseSites[[i]][[j]] <- mSites
}
}
}
human2mouseSites
i <- 1
j <- 1
hSites <- dplyr::filter(networKINu, Entry == names(uniprotHuman2Mouse)[i])
hSites
human2mouseSites[[i]] <- list()
names(human2mouseSites)[i] <- names(uniprotHuman2Mouse)[i]
human2mouseSites[[i]]
!is.null(length(uniprotHuman2Mouse[[i]]))
length(uniprotHuman2Mouse[[i]]
)
uniprotHuman2Mouse[[i]]
alignment <- getAlignment(names(uniprotHuman2Mouse)[i], uniprotHuman2Mouse[[i]][j],
upHs, upMm)
alignment
mSites <- hSites %>%
dplyr::filter(!duplicated(accAASite))
mSites
hSites
hSites %>%
dplyr::filter(!duplicated(accAASite))
mSites <- hSites %>%
dplyr::filter(!duplicated(accAASite))
mSites
tRes <- translatePosition(mSites$position, alignment)
tRes
mSites$newAcc <- rep(uniprotHuman2Mouse[[i]][j], nrow(mSites))
mSites$newAA <- tRes$AA
mSites$newPos <- tRes$pos
mSites <- mSites %>%
mutate(newAccAASite = paste0(newAcc, "_", newAA, newPos))
mSites
human2mouseSites[[i]][[j]] <- mSites
human2mouseSites[[i]][[j]]
human2mouseSites <- list()
#for(i in 1:length(uniprotHuman2Mouse)){
for(i in 1:20){
hSites <- dplyr::filter(networKINu, Entry == names(uniprotHuman2Mouse)[i])
human2mouseSites[[i]] <- list()
names(human2mouseSites)[i] <- names(uniprotHuman2Mouse)[i]
if(!is.null(length(uniprotHuman2Mouse[[i]]))){
for(j in 1:length(uniprotHuman2Mouse[[i]])){
alignment <- getAlignment(names(uniprotHuman2Mouse)[i], uniprotHuman2Mouse[[i]][j],
upHs, upMm)
mSites <- hSites %>%
dplyr::filter(!duplicated(accAASite))
tRes <- translatePosition(mSites$position, alignment)
mSites$newAcc <- rep(uniprotHuman2Mouse[[i]][j], nrow(mSites))
mSites$newAA <- tRes$AA
mSites$newPos <- tRes$pos
mSites <- mSites %>%
mutate(newAccAASite = paste0(newAcc, "_", newAA, newPos))
human2mouseSites[[i]][[j]] <- mSites
}
}
}
human2mouseSites
i <- 1
human2mouseSites[[i]]
human2mouseSites[[i]][[1]]
sapply(human2mouseSites, length)
i <- 1
i <- 2
length(human2mouseSites[[i]])
length(human2mouseSites[[i]]) == 1
do.call(rbind, human2mouseSites[[i]])
tempList <- list()
for(i in 1:length(human2mouseSites)){
if(length(human2mouseSites[[i]]) == 1){
tempList[[i]] <- human2mouseSites[[i]][[1]]
}
if(length(human2mouseSites[[i]]) > 1)
tempList[[i]] <- do.call(rbind, human2mouseSites[[i]])
}
networKINMouse <- do.call(rbind, tempList)
networKINMouse
upHs <- UniProt.ws(taxId = 9606)
upMm <- UniProt.ws(taxId = 10090)
## make a list of lists of dataframes to keep track of results.
## list 1 will be human proteins, list 2 will be mouse proteins and contents will be site mapping table
human2mouseSites <- list()
#for(i in 1:length(uniprotHuman2Mouse)){
for(i in 1:20){
hSites <- dplyr::filter(networKINu, Entry == names(uniprotHuman2Mouse)[i])
human2mouseSites[[i]] <- list()
names(human2mouseSites)[i] <- names(uniprotHuman2Mouse)[i]
if(!is.null(length(uniprotHuman2Mouse[[i]]))){
for(j in 1:length(uniprotHuman2Mouse[[i]])){
alignment <- getAlignment(names(uniprotHuman2Mouse)[i], uniprotHuman2Mouse[[i]][j],
upHs, upMm)
mSites <- hSites #%>%
#dplyr::filter(!duplicated(accAASite))
tRes <- translatePosition(mSites$position, alignment)
mSites$newAcc <- rep(uniprotHuman2Mouse[[i]][j], nrow(mSites))
mSites$newAA <- tRes$AA
mSites$newPos <- tRes$pos
mSites <- mSites %>%
mutate(newAccAASite = paste0(newAcc, "_", newAA, newPos))
human2mouseSites[[i]][[j]] <- mSites
}
}
}
nrow(networKINu)
length(uniprotHuman2Mouse)
tempList <- list()
for(i in 1:length(human2mouseSites)){
if(length(human2mouseSites[[i]]) == 1){
tempList[[i]] <- human2mouseSites[[i]][[1]]
}
if(length(human2mouseSites[[i]]) > 1)
tempList[[i]] <- do.call(rbind, human2mouseSites[[i]])
}
do.call(rbind, tempList)
length(uniprotHuman2Mouse)
for(i in 1:100){
hSites <- dplyr::filter(networKINu, Entry == names(uniprotHuman2Mouse)[i])
human2mouseSites[[i]] <- list()
names(human2mouseSites)[i] <- names(uniprotHuman2Mouse)[i]
if(!is.null(length(uniprotHuman2Mouse[[i]]))){
for(j in 1:length(uniprotHuman2Mouse[[i]])){
alignment <- getAlignment(names(uniprotHuman2Mouse)[i], uniprotHuman2Mouse[[i]][j],
upHs, upMm)
mSites <- hSites #%>%
#dplyr::filter(!duplicated(accAASite))
tRes <- translatePosition(mSites$position, alignment)
mSites$newAcc <- rep(uniprotHuman2Mouse[[i]][j], nrow(mSites))
mSites$newAA <- tRes$AA
mSites$newPos <- tRes$pos
mSites <- mSites %>%
mutate(newAccAASite = paste0(newAcc, "_", newAA, newPos))
human2mouseSites[[i]][[j]] <- mSites
}
}
}
i
j
hSites <- dplyr::filter(networKINu, Entry == names(uniprotHuman2Mouse)[i])
human2mouseSites[[i]] <- list()
names(human2mouseSites)[i] <- names(uniprotHuman2Mouse)[i]
names(human2mouseSites)[i]
uniprotHuman2Mouse[[i]]
acc1 <- names(uniprotHuman2Mouse)[i]
acc2 <- uniprotHuman2Mouse[[i]][j]
up1 <- upHs
up2 <- upMm
humanSequence <- select(up1,
keys = c(acc1),
columns = c("SEQUENCE"),
keytype = "UNIPROTKB")
mouseSequence <- select(up2,
keys = c(acc2),
columns = c("SEQUENCE"),
keytype = "UNIPROTKB")
alignment <- pairwiseAlignment(humanSequence$SEQUENCE,
mouseSequence$SEQUENCE,
substitutionMatrix = "BLOSUM50", gapOpening = -2,
gapExtension = -8, scoreOnly = FALSE)
humanSequence$SEQUENCE
mouseSequence$SEQUENCE
BLOSUM50
data(BLOSUM50)
BLOSUM50
humanSequence$SEQUENCE
gsub("U", "*", humanSequence$SEQUENCE)
humanSequence <- select(up1,
keys = c(acc1),
columns = c("SEQUENCE"),
keytype = "UNIPROTKB")
mouseSequence <- select(up2,
keys = c(acc2),
columns = c("SEQUENCE"),
keytype = "UNIPROTKB")
alignment <- pairwiseAlignment(gsub("U", "*", humanSequence$SEQUENCE),
gsub("U", "*", mouseSequence$SEQUENCE),
substitutionMatrix = "BLOSUM50", gapOpening = -2,
gapExtension = -8, scoreOnly = FALSE)
alignment
getAlignment <- function(acc1, acc2, up1, up2){
humanSequence <- select(up1,
keys = c(acc1),
columns = c("SEQUENCE"),
keytype = "UNIPROTKB")
mouseSequence <- select(up2,
keys = c(acc2),
columns = c("SEQUENCE"),
keytype = "UNIPROTKB")
alignment <- pairwiseAlignment(gsub("U", "*", humanSequence$SEQUENCE),
gsub("U", "*", mouseSequence$SEQUENCE),
substitutionMatrix = "BLOSUM50", gapOpening = -2,
gapExtension = -8, scoreOnly = FALSE)
alignment
}
