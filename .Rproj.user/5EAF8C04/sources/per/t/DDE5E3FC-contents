---
title: "Untitled"
output: html_document
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = FALSE)
```

```{r}
library(conflicted)
library(tidyverse)
library(seqinr)
library(UniProt.ws)
library(Biostrings)
```




```{r}
networKIN <- read.delim("E:\\Documents\\NJC\\networKINmouse\\data\\networkin_human_predictions_3.1.tsv",
                        stringsAsFactors = FALSE)
## Make ensembl2uniprot
writeClipboard(unique(networKIN$string_identifier))
ensembl2uniprot <- read.delim("data/ensembl2uniprot.tab", stringsAsFactors = FALSE)
names(ensembl2uniprot)[1] <- "ensemble"
networKINu <- inner_join(networKIN, ensembl2uniprot,
                         by = c("string_identifier" = "ensemble"))
nrow(networKIN)
nrow(networKINu)

## make uniprot2refseq50
writeClipboard(ensembl2uniprot$Entry)
uniprot2refseqGroups <- read.delim("data/uniprot2refseqGroups.tab", stringsAsFactors = FALSE)
names(uniprot2refseqGroups)[1] <- "uniprot"

## get mouse homologs
uniprotHuman2Mouse <- list()
for(i in 1:nrow(uniprot2refseqGroups)){
  clusterSpecies <- base::strsplit(uniprot2refseqGroups$Organisms[i], "; ")[[1]]
  clusterProteins <- base::strsplit(uniprot2refseqGroups$Cluster.members[i], "; ")[[1]]
  uniprotHuman2Mouse[[i]] <- clusterProteins[clusterSpecies == "Mus musculus (Mouse)"]
  names(uniprotHuman2Mouse)[i] <- uniprot2refseqGroups$uniprot[i]
}
```

```{r}
## pairwise sequence alignments between human and mouse
upHs <- UniProt.ws(taxId = 9606)
upMm <- UniProt.ws(taxId = 10090)

i <- 1
j <- 1

humanSequence <- select(upHs,
              keys = c(names(uniprotHuman2Mouse)[i]), 
              columns = c("SEQUENCE"), 
              keytype = "UNIPROTKB")
mouseSequence <- select(upMm,
              keys = c(uniprotHuman2Mouse[[i]][j]), 
              columns = c("SEQUENCE"), 
              keytype = "UNIPROTKB")
dotPlot(base::strsplit(humanSequence$SEQUENCE, split = "")[[1]], 
        base::strsplit(mouseSequence$SEQUENCE, split = "")[[1]])

alignment <- pairwiseAlignment(humanSequence$SEQUENCE, 
                               mouseSequence$SEQUENCE, 
                               substitutionMatrix = "BLOSUM50", gapOpening = -2,
                               gapExtension = -8, scoreOnly = FALSE)

alignment

s <- subject(alignment)
aligned(s)

p <- pattern(alignment)
str(aligned(p))

networKIN$X.substrate

```






